### [CVE-2020-36791](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-36791)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=73c29d2f6f8ae731b1e09051b69ed3ba2319482b%3C%20d6cdc5bb19b595486fb2e6661e5138d73a57f454%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=brighgreen)

### Description

In the Linux kernel, the following vulnerability has been resolved:net_sched: keep alloc_hash updated after hash allocationIn commit 599be01ee567 ("net_sched: fix an OOB access in cls_tcindex")I moved cp->hash calculation before the firsttcindex_alloc_perfect_hash(), but cp->alloc_hash is left untouched.This difference could lead to another out of bound access.cp->alloc_hash should always be the size allocated, we shouldupdate it after this tcindex_alloc_perfect_hash().

### POC

#### Reference
- https://blog.cdthoughts.ch/2021/03/16/syzbot-bug.html

#### Github
No PoCs found on GitHub currently.

